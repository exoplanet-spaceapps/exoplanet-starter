# ğŸ“Š æ•¸æ“šåˆ‡åˆ†ç­–ç•¥èªªæ˜

**Exoplanet Detection - Training/Validation/Testing Data Split Strategy**

æœ¬æ–‡æª”è©³ç´°èªªæ˜æœ¬å°ˆæ¡ˆä¸­æ©Ÿå™¨å­¸ç¿’è¨“ç·´æ™‚çš„æ•¸æ“šä¾†æºã€åˆ‡åˆ†æ¯”ä¾‹èˆ‡ä½¿ç”¨ç­–ç•¥ã€‚

---

## ğŸ“‹ ç›®éŒ„

1. [æ•¸æ“šä¾†æº](#æ•¸æ“šä¾†æº)
2. [æ•¸æ“šåˆ‡åˆ†æµç¨‹](#æ•¸æ“šåˆ‡åˆ†æµç¨‹)
3. [å„æ¨¡å‹çš„åˆ‡åˆ†ç­–ç•¥](#å„æ¨¡å‹çš„åˆ‡åˆ†ç­–ç•¥)
4. [é—œéµè¨­è¨ˆæ±ºç­–](#é—œéµè¨­è¨ˆæ±ºç­–)

---

## æ•¸æ“šä¾†æº

### åŸå§‹æ•¸æ“šé›†
```
MAST Archive (TESS)
    â†“
supervised_dataset.csv (11,979 ç­†)
â”œâ”€ True (æœ‰ç³»å¤–è¡Œæ˜Ÿ): 5,944 ç­†
â””â”€ False (ç„¡ç³»å¤–è¡Œæ˜Ÿ): 6,035 ç­†
```

**ä¾†æº**: NASA TESS ä»»å‹™çš„å…‰è®Šæ›²ç·šæ•¸æ“šï¼Œé€šé MAST Archive ä¸‹è¼‰

---

## æ•¸æ“šåˆ‡åˆ†æµç¨‹

### å®Œæ•´æµç¨‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MAST Archive (TESS)                                 â”‚
â”‚ åŸå§‹ Lightcurve æ•¸æ“š                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ supervised_dataset.csv (11,979 ç­†)                  â”‚
â”‚ â”œâ”€ True (æœ‰è¡Œæ˜Ÿ): 5,944 ç­†                          â”‚
â”‚ â””â”€ False (ç„¡è¡Œæ˜Ÿ): 6,035 ç­†                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼ [extract_balanced_features.py]
                   â”‚ (éš¨æ©ŸæŠ½æ¨£, random_state=42)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ balanced_features.csv (1,000 ç­†)                    â”‚
â”‚ â”œâ”€ True: 500 ç­†                                     â”‚
â”‚ â””â”€ False: 500 ç­†                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼ [train_test_split]
                   â”‚ test_size=0.2, stratify=y
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                     â”‚
        â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è¨“ç·´é›† (80%) â”‚    â”‚ æ¸¬è©¦é›† (20%) â”‚
â”‚ 800 ç­†       â”‚    â”‚ 200 ç­†       â”‚
â”‚ â”œâ”€ True: 400â”‚    â”‚ â”œâ”€ True: 100â”‚
â”‚ â””â”€ False:400â”‚    â”‚ â””â”€ False:100â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                    â–²
       â”‚                    â”‚
       â”‚                    â”‚ æœ€çµ‚è©•ä¼°
       â–¼                    â”‚
  [å…©ç¨®ç­–ç•¥]                 â”‚
       â”‚                    â”‚
  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”               â”‚
  â”‚         â”‚               â”‚
  â–¼         â–¼               â”‚
â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚ç›´æ¥â”‚  â”‚5-Fold  â”‚          â”‚
â”‚è¨“ç·´â”‚  â”‚Cross   â”‚          â”‚
â”‚    â”‚  â”‚Valid.  â”‚          â”‚
â””â”€â”¬â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â”‚
  â”‚         â”‚               â”‚
  â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”         â”‚
  â”‚    â–¼          â–¼         â”‚
  â”‚  Fold1-5   é¸æœ€ä½³       â”‚
  â”‚  (å…§éƒ¨)    è¶…åƒæ•¸        â”‚
  â”‚            â”‚            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
          æœ€çµ‚æ¨¡å‹
```

---

## å„æ¨¡å‹çš„åˆ‡åˆ†ç­–ç•¥

### 1ï¸âƒ£ XGBoost Baseline (`train_model_local.py`)

#### æ•¸æ“šåˆ‡åˆ†
```python
# Step 1: å¹³è¡¡æŠ½æ¨£
balanced_features.csv: 1,000 ç­†
â”œâ”€ True: 500 ç­† (å¾ 5,944 ç­†ä¸­éš¨æ©ŸæŠ½)
â””â”€ False: 500 ç­† (å¾ 6,035 ç­†ä¸­éš¨æ©ŸæŠ½)

# Step 2: Train-Test Split (80-20)
train_test_split(test_size=0.2, random_state=42, stratify=y)

è¨“ç·´é›† (X_train, y_train): 800 ç­†
â”œâ”€ True: 400 ç­† (50%)
â””â”€ False: 400 ç­† (50%)

æ¸¬è©¦é›† (X_test, y_test): 200 ç­†
â”œâ”€ True: 100 ç­† (50%)
â””â”€ False: 100 ç­† (50%)
```

#### è¨“ç·´æµç¨‹
- **è¨“ç·´**: ç›´æ¥åœ¨ 800 ç­†è¨“ç·´é›†ä¸Šè¨“ç·´ XGBoost æ¨¡å‹
- **è©•ä¼°**: åœ¨ 200 ç­†æ¸¬è©¦é›†ä¸Šè©•ä¼°æœ€çµ‚æ•ˆèƒ½
- **ç„¡ Validation Set**: æ²’æœ‰ä½¿ç”¨ç¨ç«‹çš„é©—è­‰é›†æˆ–äº¤å‰é©—è­‰

#### ç¨‹å¼ç¢¼ç‰‡æ®µ
```python
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)

model = xgb.XGBClassifier(**params)
model.fit(X_train, y_train)

# æœ€çµ‚è©•ä¼°
y_pred = model.predict(X_test)
roc_auc = roc_auc_score(y_test, model.predict_proba(X_test)[:, 1])
```

---

### 2ï¸âƒ£ XGBoost Optuna (`train_xgboost_optuna.py`)

#### æ•¸æ“šåˆ‡åˆ†
ç›¸åŒçš„ Train-Test Split (800 è¨“ç·´ + 200 æ¸¬è©¦)

#### é¡å¤–ä½¿ç”¨ 5-Fold Cross-Validation
```python
cross_val_score(model, X_train, y_train, cv=5)

æ¯å€‹ Fold çš„åˆ‡åˆ† (åœ¨ 800 ç­†è¨“ç·´é›†å…§):
â”œâ”€ Training Fold: 640 ç­† (80% of 800)
â””â”€ Validation Fold: 160 ç­† (20% of 800)

é‡è¤‡ 5 æ¬¡ï¼Œæ¯æ¬¡ä¸åŒçš„ Fold ä½œç‚º Validation
```

#### è¨“ç·´æµç¨‹

**éšæ®µ 1: Optuna è¶…åƒæ•¸æœç´¢**
1. Optuna ç”Ÿæˆå€™é¸è¶…åƒæ•¸çµ„åˆ
2. å°æ¯çµ„è¶…åƒæ•¸ï¼š
   - åœ¨è¨“ç·´é›† (800 ç­†) ä¸Šåš **5-Fold Cross-Validation**
   - æ¯å€‹ Fold åˆ†ç‚º Training (640) å’Œ Validation (160)
   - è¨ˆç®— 5 å€‹ Fold çš„å¹³å‡ ROC-AUC
3. é¸æ“‡å¹³å‡ ROC-AUC æœ€é«˜çš„è¶…åƒæ•¸çµ„åˆ

**éšæ®µ 2: æœ€çµ‚æ¨¡å‹è¨“ç·´**
1. ä½¿ç”¨æœ€ä½³è¶…åƒæ•¸
2. åœ¨æ•´å€‹è¨“ç·´é›† (800 ç­†) ä¸Šè¨“ç·´
3. åœ¨æ¸¬è©¦é›† (200 ç­†) ä¸Šè©•ä¼°

#### Validation Set ä¾†æº
- **å…§éƒ¨ Validation**: 5-Fold CV ä¸­çš„æ¯å€‹ Validation Fold (160 ç­†)
- é€™äº› Validation Fold æ˜¯å¾è¨“ç·´é›† (800 ç­†) ä¸­**å‹•æ…‹åˆ‡åˆ†**çš„
- **ä¸æ˜¯**ç¨ç«‹çš„ç¬¬ä¸‰å€‹æ•¸æ“šé›†ï¼Œè€Œæ˜¯å¾è¨“ç·´é›†ä¸­è¼ªæµæŠ½å–

#### ç¨‹å¼ç¢¼ç‰‡æ®µ
```python
def objective(trial):
    params = {
        'max_depth': trial.suggest_int('max_depth', 3, 10),
        'learning_rate': trial.suggest_float('learning_rate', 0.01, 0.3),
        # ... å…¶ä»–è¶…åƒæ•¸
    }

    model = xgb.XGBClassifier(**params)

    # 5-Fold Cross-Validation (åªåœ¨è¨“ç·´é›†ä¸Š)
    cv_scores = cross_val_score(
        model, X_train, y_train,
        cv=5, scoring='roc_auc', n_jobs=-1
    )

    return cv_scores.mean()  # è¿”å›å¹³å‡ ROC-AUC

# Optuna æœç´¢
study = optuna.create_study(direction='maximize')
study.optimize(objective, n_trials=50)

# ä½¿ç”¨æœ€ä½³è¶…åƒæ•¸è¨“ç·´æœ€çµ‚æ¨¡å‹
best_model = xgb.XGBClassifier(**study.best_params)
best_model.fit(X_train, y_train)
```

---

### 3ï¸âƒ£ Genesis CNN (`train_genesis_cnn.py`)

#### æ•¸æ“šåˆ‡åˆ†
ç›¸åŒçš„ Train-Test Split (800 è¨“ç·´ + 200 æ¸¬è©¦)

#### PyTorch DataLoader
```python
è¨“ç·´é›†: 800 ç­† â†’ DataLoader (batch_size=32)
æ¸¬è©¦é›†: 200 ç­† â†’ DataLoader (batch_size=32)

è¨“ç·´éç¨‹ï¼š
â”œâ”€ æ¯å€‹ Epoch: åœ¨è¨“ç·´é›† (800 ç­†) ä¸Šè¨“ç·´
â””â”€ æ¯å€‹ Epoch çµæŸ: åœ¨æ¸¬è©¦é›† (200 ç­†) ä¸Šé©—è­‰
```

#### Validation Set ç­–ç•¥
- **ç›´æ¥ä½¿ç”¨æ¸¬è©¦é›†ä½œç‚º Validation**
- æ¯å€‹ Epoch è¨“ç·´å®Œå¾Œï¼Œåœ¨æ¸¬è©¦é›†ä¸Šè¨ˆç®— ROC-AUC
- å„²å­˜ Validation ROC-AUC æœ€é«˜çš„æ¨¡å‹

#### è¨“ç·´æµç¨‹
```python
for epoch in range(EPOCHS):
    # Training
    model.train()
    for batch_flux, batch_labels in train_loader:
        # ... è¨“ç·´æ­¥é©Ÿ

    # Validation (ä½¿ç”¨æ¸¬è©¦é›†)
    model.eval()
    for batch_flux, batch_labels in test_loader:
        # ... é©—è­‰æ­¥é©Ÿ

    val_auc = roc_auc_score(all_labels, all_preds)

    # å„²å­˜æœ€ä½³æ¨¡å‹
    if val_auc > best_roc_auc:
        best_roc_auc = val_auc
        torch.save(model.state_dict(), 'genesis_cnn_best.pth')
```

#### âš ï¸ æ³¨æ„äº‹é …
- æ¸¬è©¦é›†åŒæ™‚ä½œç‚º Validation å’Œæœ€çµ‚è©•ä¼°
- é€™ä¸æ˜¯ç†æƒ³åšæ³•ï¼ˆæœƒæœ‰æ•¸æ“šæ´©æ¼é¢¨éšªï¼‰
- ç†æƒ³æƒ…æ³æ‡‰è©²æœ‰ç¨ç«‹çš„ Train/Validation/Test ä¸‰å€‹é›†åˆ
- åœ¨å°æ•¸æ“šé›† (1,000 ç­†) çš„æƒ…æ³ä¸‹ï¼Œé€™æ˜¯å¸¸è¦‹çš„æ¬Šè¡¡

---

### 4ï¸âƒ£ Advanced XGBoost (`train_advanced_model.py`)

#### ç‰¹å¾µæ•¸é‡
- 21 å€‹é€²éšç‰¹å¾µï¼ˆåŸºç¤ 11 + æ™‚åº 4 + é »åŸŸ 3 + å°æ³¢ 3ï¼‰

#### æ•¸æ“šåˆ‡åˆ†
èˆ‡ XGBoost Baseline å®Œå…¨ç›¸åŒï¼š
- è¨“ç·´é›†: 800 ç­†
- æ¸¬è©¦é›†: 200 ç­†
- ç„¡é¡å¤– Validation Set

#### è¶…åƒæ•¸
ä½¿ç”¨ Optuna èª¿å„ªå¾Œçš„æœ€ä½³è¶…åƒæ•¸ï¼ˆå¾ `train_xgboost_optuna.py` å¾—åˆ°ï¼‰

---

## æ•¸æ“šåˆ‡åˆ†ç¸½çµè¡¨

| æ¨¡å‹ | è¨“ç·´é›† | Validation | æ¸¬è©¦é›† | CV Folds | ç‰¹å¾µæ•¸ |
|------|--------|-----------|--------|----------|--------|
| **XGBoost Baseline** | 800 ç­† | âŒ ç„¡ | 200 ç­† | âŒ | 11 |
| **XGBoost Optuna** | 800 ç­† | âœ… 5-Fold (å…§éƒ¨) | 200 ç­† | âœ… 5 | 11 |
| **Genesis CNN** | 800 ç­† | 200 ç­† (=æ¸¬è©¦é›†) | 200 ç­† | âŒ | Raw data |
| **Advanced XGBoost** | 800 ç­† | âŒ ç„¡ | 200 ç­† | âŒ | 21 |

---

## é—œéµè¨­è¨ˆæ±ºç­–

### 1. å¹³è¡¡æŠ½æ¨£ (Balanced Sampling)

**ç‚ºä»€éº¼éœ€è¦ï¼Ÿ**
```
åŸå§‹æ•¸æ“š: 5,944 True vs 6,035 False (æ¥è¿‘å¹³è¡¡ä½†ä¸å®Œå…¨)
æŠ½æ¨£å¾Œ:   500 True vs 500 False (å®Œå…¨å¹³è¡¡)
```

**å¥½è™•:**
- é¿å…é¡åˆ¥ä¸å¹³è¡¡å•é¡Œ
- æ¨¡å‹ä¸æœƒåå‘å¤šæ•¸é¡åˆ¥
- è©•ä¼°æŒ‡æ¨™æ›´æœ‰æ„ç¾©

**å¯¦ä½œ:**
```python
balanced_df = pd.concat([
    df_true.sample(n=500, random_state=42),   # 500 ç­† True
    df_false.sample(n=500, random_state=42)   # 500 ç­† False
])
```

---

### 2. Stratified Split (åˆ†å±¤åˆ‡åˆ†)

**ä½œç”¨:**
- ç¢ºä¿è¨“ç·´é›†å’Œæ¸¬è©¦é›†éƒ½ä¿æŒ 50%-50% çš„é¡åˆ¥æ¯”ä¾‹
- é¿å…åˆ‡åˆ†å¾Œé¡åˆ¥ä¸å¹³è¡¡

**å¯¦ä½œ:**
```python
train_test_split(X, y, test_size=0.2, random_state=42, stratify=y)
```

**çµæœ:**
```
è¨“ç·´é›†: 400 True (50%) + 400 False (50%) = 800 ç­†
æ¸¬è©¦é›†: 100 True (50%) + 100 False (50%) = 200 ç­†
```

---

### 3. å›ºå®š Random State

**ç›®çš„:**
- ç¢ºä¿æ¯æ¬¡åŸ·è¡Œæ™‚æ•¸æ“šåˆ‡åˆ†çµæœä¸€è‡´
- æ–¹ä¾¿çµæœé‡ç¾èˆ‡æ¯”è¼ƒ

**å¯¦ä½œ:**
```python
random_state=42  # æ‰€æœ‰éš¨æ©Ÿæ“ä½œéƒ½ä½¿ç”¨ç›¸åŒçš„ seed
```

---

### 4. 80-20 åˆ‡åˆ†æ¯”ä¾‹

**é¸æ“‡ç†ç”±:**
- **80% è¨“ç·´**: è¶³å¤ çš„æ•¸æ“šè®“æ¨¡å‹å­¸ç¿’æ¨¡å¼
- **20% æ¸¬è©¦**: è¶³å¤ çš„æ•¸æ“šè©•ä¼°æ³›åŒ–èƒ½åŠ›
- **æ¨™æº–åšæ³•**: ML é ˜åŸŸå¸¸è¦‹çš„åˆ‡åˆ†æ¯”ä¾‹

**åœ¨å°æ•¸æ“šé›† (1,000 ç­†) çš„æ¬Šè¡¡:**
- è¨“ç·´é›† 800 ç­†å¯èƒ½åå°‘ï¼ˆç†æƒ³æ˜¯æ•¸åƒç­†ï¼‰
- æ¸¬è©¦é›† 200 ç­†è¶³å¤ è©•ä¼°ä½†çµ±è¨ˆèª¤å·®è¼ƒå¤§
- æœªä¾†å¯ä»¥ä½¿ç”¨å…¨éƒ¨ 11,979 ç­†æ•¸æ“šæå‡æ•ˆèƒ½

---

### 5. Cross-Validation ç­–ç•¥

**åƒ…åœ¨ Optuna è¶…åƒæ•¸èª¿å„ªæ™‚ä½¿ç”¨:**

**ç‚ºä»€éº¼åªç”¨åœ¨ Optunaï¼Ÿ**
- è¶…åƒæ•¸èª¿å„ªéœ€è¦å¯é çš„é©—è­‰åˆ†æ•¸
- å–®æ¬¡ Train-Val Split å¯èƒ½æœ‰åå·®
- 5-Fold CV æä¾›æ›´ç©©å¥çš„è©•ä¼°

**ç‚ºä»€éº¼å…¶ä»–æ¨¡å‹ä¸ç”¨ CVï¼Ÿ**
- è¨“ç·´æ™‚é–“è€ƒé‡ï¼ˆCV æœƒå¢åŠ  5 å€æ™‚é–“ï¼‰
- å°æ•¸æ“šé›†ä¸Š CV çš„æ•ˆç›Šæœ‰é™
- ä¸»è¦é—œæ³¨æœ€çµ‚æ¸¬è©¦é›†æ•ˆèƒ½

---

### 6. Validation Set çš„ä¸‰ç¨®æ–¹å¼

#### æ–¹å¼ 1: ç„¡ç¨ç«‹ Validation (Baseline & Advanced)
```
åªæœ‰ Train å’Œ Testï¼Œç›´æ¥åœ¨ Test ä¸Šè©•ä¼°
å„ªé»: ç°¡å–®ç›´æ¥
ç¼ºé»: ç„¡æ³•æå‰èª¿æ•´æ¨¡å‹
```

#### æ–¹å¼ 2: K-Fold CV Validation (Optuna)
```
åœ¨è¨“ç·´é›†å…§åšäº¤å‰é©—è­‰
å„ªé»: å……åˆ†åˆ©ç”¨è¨“ç·´æ•¸æ“šï¼Œè©•ä¼°ç©©å¥
ç¼ºé»: è¨“ç·´æ™‚é–“é•·
```

#### æ–¹å¼ 3: ä½¿ç”¨ Test ä½œç‚º Validation (Genesis CNN)
```
è¨“ç·´æ™‚ç”¨ Test ç›£æ§ï¼Œä¿å­˜æœ€ä½³æ¨¡å‹
å„ªé»: å¯¦ä½œç°¡å–®ï¼Œé©åˆæ—©åœ
ç¼ºé»: æ•¸æ“šæ´©æ¼é¢¨éšªï¼Œæ¸¬è©¦é›†æ•ˆèƒ½å¯èƒ½éæ–¼æ¨‚è§€
```

---

## æ•¸æ“šæµç¨‹ç¸½çµ

### å®Œæ•´ Pipeline

```
1. åŸå§‹æ•¸æ“š (11,979 ç­†)
   â†“
2. å¹³è¡¡æŠ½æ¨£ (1,000 ç­†, random_state=42)
   â†“
3. ç‰¹å¾µæå– (balanced_features.csv)
   â†“
4. Train-Test Split (80-20, stratified)
   â”œâ”€ è¨“ç·´é›† 800 ç­†
   â””â”€ æ¸¬è©¦é›† 200 ç­†
   â†“
5. æ¨¡å‹è¨“ç·´
   â”œâ”€ Baseline: ç›´æ¥è¨“ç·´
   â”œâ”€ Optuna: 5-Fold CV â†’ æœ€ä½³è¶…åƒæ•¸ â†’ è¨“ç·´
   â”œâ”€ Genesis CNN: è¨“ç·´ + Test Validation
   â””â”€ Advanced: ä½¿ç”¨ Optuna è¶…åƒæ•¸è¨“ç·´
   â†“
6. æ¸¬è©¦é›†è©•ä¼° (200 ç­†)
   â”œâ”€ ROC-AUC
   â”œâ”€ Accuracy, Precision, Recall, F1
   â””â”€ Confusion Matrix
```

---

## æœ€ä½³å¯¦è¸å»ºè­°

### ç•¶å‰è¨­ç½®çš„å„ªé»
âœ… é¡åˆ¥å¹³è¡¡ (50-50)
âœ… Stratified split ä¿æŒæ¯”ä¾‹
âœ… Random state å›ºå®šå¯é‡ç¾
âœ… Optuna ä½¿ç”¨ CV é¿å…éæ“¬åˆ

### æœªä¾†æ”¹é€²æ–¹å‘

#### 1. ä½¿ç”¨æ›´å¤šæ•¸æ“š
```
ç•¶å‰: 1,000 ç­†
æœªä¾†: 11,979 ç­†å…¨éƒ¨æ•¸æ“š
é æœŸæ•ˆç›Š: ROC-AUC å¯èƒ½æå‡ 5-10%
```

#### 2. ä¸‰åˆ†åˆ‡å‰² (Train/Val/Test)
```
è¨“ç·´é›†: 70% (8,385 ç­†)
é©—è­‰é›†: 15% (1,797 ç­†)
æ¸¬è©¦é›†: 15% (1,797 ç­†)
```

#### 3. K-Fold ç”¨æ–¼æœ€çµ‚è©•ä¼°
```
å°æ‰€æœ‰æ¨¡å‹ä½¿ç”¨ 5-Fold CV
å ±å‘Šå¹³å‡æ•ˆèƒ½å’Œæ¨™æº–å·®
æä¾›æ›´å¯é çš„æ•ˆèƒ½ä¼°è¨ˆ
```

---

## åƒè€ƒè³‡æ–™

### ç›¸é—œæª”æ¡ˆ
- æ•¸æ“šæŠ½æ¨£: `scripts/extract_balanced_features.py`
- è¨“ç·´è…³æœ¬:
  - `scripts/train_model_local.py` (Baseline)
  - `scripts/train_xgboost_optuna.py` (Optuna)
  - `scripts/train_genesis_cnn.py` (CNN)
  - `scripts/train_advanced_model.py` (Advanced)
- è¨“ç·´æŒ‡å—: `docs/ML_TRAINING_GUIDE.md`

### æ•¸æ“šä¾†æº
- MAST Archive: https://mast.stsci.edu/portal/Mashup/Clients/Mast/Portal.html
- TESS Mission: https://tess.mit.edu/

---

**æœ€å¾Œæ›´æ–°**: 2025-10-05
**ç‰ˆæœ¬**: 1.0
**ä½œè€…**: Exoplanet Detection Team
